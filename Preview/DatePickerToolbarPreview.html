<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LifeTimer é¢„è§ˆï¼šå·¥å…·æ æ—¥æœŸé€‰æ‹©äº¤äº’</title>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 24px; color: #1f2937; }
    .toolbar { display: flex; gap: 12px; align-items: center; padding: 12px 16px; border: 1px solid #e5e7eb; border-radius: 10px; background: #fafafa; }
    .date-label { padding: 4px 8px; border-radius: 6px; cursor: pointer; }
    .date-label:hover { background: #f0f0f0; }
    .popover { position: absolute; margin-top: 8px; padding: 12px; width: 320px; border: 1px solid #e5e7eb; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.12); background: #fff; }
    .popover h4 { margin: 0 0 8px 0; font-size: 14px; color: #6b7280; }
    .actions { display: flex; gap: 8px; align-items: center; margin-top: 10px; }
    .actions button { padding: 6px 10px; border-radius: 8px; border: 1px solid #e5e7eb; background: #fff; cursor: pointer; }
    .actions button:hover { background: #f9fafb; }
    .actions .spacer { flex: 1; }
    .caption { color: #6b7280; font-size: 13px; margin-top: 16px; }
  </style>
</head>
<body>
  <h2>å·¥å…·æ æ—¥æœŸé€‰æ‹©äº¤äº’é¢„è§ˆ</h2>
  <p>æ­¤é¡µé¢æ¨¡æ‹Ÿåœ¨ ActivityStatsView å·¥å…·æ ä¸­ç‚¹å‡»æ—¥æœŸæ–‡å­—åå¼¹å‡ºæ—¥æœŸé€‰æ‹©å™¨ï¼ˆPopoverï¼‰ï¼Œç”¨äºåˆ‡æ¢æŸ¥çœ‹æ•°æ®æ—¥æœŸã€‚</p>

  <div class="toolbar">
    <div id="dateLabel" class="date-label"><span style="color:#6b7280;">ğŸ“…</span> <span id="dateText">08æœˆ12æ—¥</span> <span style="color:#6b7280;">â–¾</span></div>
    <div class="actions">
      <button onclick="prevDay()">âŸ¨ å‰ä¸€å¤©</button>
      <button onclick="nextDay()">åä¸€å¤© âŸ©</button>
      <div class="spacer"></div>
      <button onclick="goToday()" id="todayBtn">ä»Šå¤©</button>
    </div>
  </div>

  <div id="popover" class="popover" style="display:none;">
    <h4>é€‰æ‹©æ—¥æœŸ</h4>
    <input type="date" id="dateInput" />
    <div class="actions">
      <button onclick="prevDay()">âŸ¨ å‰ä¸€å¤©</button>
      <button onclick="nextDay()">åä¸€å¤© âŸ©</button>
      <div class="spacer"></div>
      <button onclick="goToday()" id="todayBtn2">ä»Šå¤©</button>
    </div>
  </div>

  <p class="caption">è¯´æ˜ï¼šåœ¨çœŸå®åº”ç”¨ä¸­ï¼Œç‚¹å‡»â€œ08æœˆ12æ—¥â€ä¼šå‡ºç° SwiftUI çš„ popoverï¼Œå†…å®¹åŒ…å« DatePickerï¼ˆiOS ä½¿ç”¨ graphical æ ·å¼ï¼ŒmacOS ä½¿ç”¨é»˜è®¤æ ·å¼ï¼‰ä»¥åŠå¿«æ·æŒ‰é’®â€œå‰ä¸€å¤©/åä¸€å¤©/ä»Šå¤©â€ã€‚é€‰æ‹©åä¼šè§¦å‘æ•°æ®åˆ·æ–°ã€‚</p>

  <script>
    const dateLabel = document.getElementById('dateLabel');
    const popover = document.getElementById('popover');
    const dateInput = document.getElementById('dateInput');

    function formatLabel(date) {
      const d = new Date(date);
      const month = String(d.getMonth() + 1).padStart(2, '0');
      const day = String(d.getDate()).padStart(2, '0');
      return `${month}æœˆ${day}æ—¥`;
    }

    function setLabel(date) {
      document.getElementById('dateText').textContent = formatLabel(date);
      dateInput.valueAsDate = new Date(date);
      const today = new Date();
      const isToday = today.toDateString() === new Date(date).toDateString();
      document.getElementById('todayBtn').disabled = isToday;
      document.getElementById('todayBtn2').disabled = isToday;
    }

    function togglePopover() {
      if (popover.style.display === 'none') {
        const rect = dateLabel.getBoundingClientRect();
        popover.style.left = rect.left + 'px';
        popover.style.top = (rect.bottom + window.scrollY) + 'px';
        popover.style.display = 'block';
      } else {
        popover.style.display = 'none';
      }
    }

    dateLabel.addEventListener('click', togglePopover);
    dateInput.addEventListener('change', () => {
      const d = dateInput.valueAsDate || new Date();
      setLabel(d);
    });

    function prevDay() {
      const d = dateInput.valueAsDate || new Date();
      d.setDate(d.getDate() - 1);
      setLabel(d);
    }

    function nextDay() {
      const d = dateInput.valueAsDate || new Date();
      d.setDate(d.getDate() + 1);
      setLabel(d);
    }

    function goToday() {
      const d = new Date();
      setLabel(d);
    }

    // åˆå§‹åŒ–ä¸ºä»Šå¤©
    setLabel(new Date());
  </script>
</body>
</html>